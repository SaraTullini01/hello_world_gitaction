name: Notifier

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:

#   messageSlack:
#     runs-on: ubuntu-latest
#     steps:
#     - name: Notification Slack
#       uses: rtCamp/action-slack-notify@v2
#       env:
#         SLACK_CHANNEL: ci
#         SLACK_TITLE: Post Title
#         SLACK_USERNAME: BotCI
#         SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK_URL }}
#         SLACK_MESSAGE: "This is your custom message."

#   notifyWhatsApp:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@master
#       - name: Notification WhatsApp
#         id: whatsapp-notify
#         env:
#           account_sid: ${{ secrets.twilio_account_sid }}
#           auth_token: ${{ secrets.twilio_auth_token }}
#           to_whatsapp_no: ${{ secrets.twilio_to_whatsapp_no }}
#           message: "CI üëâüèª Your message here..."
#         uses: khaled-ibtikar/whatsapp-push-notify-action@master
        
#   notifyTelegram:
#     runs-on: ubuntu-latest
#     steps:
#     # - name: Get channel members
#     #   id: get-members
#     #   run: |
#     #     curl -X GET "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/getChatMembersCount?chat_id=${{ secrets.TELEGRAM_CHAT }}" -o members.json
#     #     members=$(cat members.json | jq '.result')
#     #     echo "::set-output name=members::$members"
#     - name: Send message to channel members
#       id: send-message
#       run: |
#         curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" -d "chat_id=${{ secrets.TELEGRAM_CHAT }}" -d "text=Ciao! E' stato effettuato un nuovo commit nel repository. Vieni a vedere!"
#         # members=$(echo ${{ steps.get-members.outputs.members }})
#         # for member in $(seq 0 $(($members-1))); do
#         #     curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" -d "chat_id=${{ secrets.TELEGRAM_CHAT }}" -d "text=Hello member $member!"
#         # done
  notifyTelegram:
    runs-on: ubuntu-latest
    steps:
      - name: Notify on Commit
        run: |
            TELEGRAM_API_URL="https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage"
            MESSAGE="Questo √® un messaggio di notifica da GitHub Actions!"
            
            curl -X POST -H "Content-Type: application/json" -d "{\"chat_id\":\"${{ secrets.TELEGRAM_CHAT_ID }}\",\"text\":\"${MESSAGE}\"}" ${TELEGRAM_API_URL}
